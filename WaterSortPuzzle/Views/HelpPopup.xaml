<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:enums="clr-namespace:WaterSortPuzzle.Enums"
             xmlns:views="clr-namespace:WaterSortPuzzle.Views"
             xmlns:viewModels="clr-namespace:WaterSortPuzzle.ViewModels"
             x:Class="WaterSortPuzzle.Views.HelpPopup"
             HorizontalOptions="Fill"
             VerticalOptions="Fill"
             BackgroundColor="#00000000"
             WidthRequest="{Binding DeviceWidth}"
             HeightRequest="{Binding DeviceHeight}"
             Margin="0"
             Padding="0"
             x:DataType="viewModels:HelpPopupVM">
    <ContentView.Resources>
        <Style TargetType="Label" BasedOn="{StaticResource BasicLabelStyle}">
            <Setter Property="TextColor" Value="White" />
            <Setter Property="HorizontalTextAlignment" Value="Center" />
        </Style>

        <Style TargetType="Label" x:Key="Title">
            <Setter Property="FontSize" Value="30" />
            <Setter Property="Margin" Value="0,55,0,15" />
        </Style>

        <Style TargetType="Label" x:Key="Message">
            <Setter Property="Margin" Value="0,0,0,20" />
        </Style>

        <Style TargetType="Button" BasedOn="{StaticResource BasicButtonStyle}">
            <Setter Property="CornerRadius" Value="50"/>
            <Setter Property="HeightRequest" Value="60" />
        </Style>

        <Style TargetType="Button" x:Key="Confirm">
            <Setter Property="Background" Value="Green" />
        </Style>
        
        <Style TargetType="Button" x:Key="MenuButton">
            <Setter Property="Margin" Value="30,10,30,0" />
        </Style>

        <Style TargetType="Button" x:Key="Cancel">
            <Setter Property="Background" Value="OrangeRed" />
        </Style>

        <Style x:Key="NavigationButton" TargetType="Button">
            <Setter Property="CornerRadius" Value="15" />
        </Style>
        
        <Style x:Key="LabelBullets" TargetType="Label">
            <Setter Property="HorizontalOptions" Value="Start" />
            <Setter Property="Margin" Value="0,5" />
        </Style>
    </ContentView.Resources>

    <Grid Margin="0">

        <AbsoluteLayout IsVisible="{Binding Current}">
            <BoxView
                BackgroundColor="#80000000"
                AbsoluteLayout.LayoutBounds="0,0,1,1"
                AbsoluteLayout.LayoutFlags="All" />

            <Border
                IsVisible="{Binding MainVM.Current}"
                AbsoluteLayout.LayoutBounds="{Binding MainVM.Current.TargetBounds}"
                AbsoluteLayout.LayoutFlags="None"
                Padding="5"
                StrokeThickness="1"
                BackgroundColor="{StaticResource HelpPopupBackground}">
                <Label Text="{Binding MainVM.Current.Text}" HorizontalOptions="Start" />
            </Border>
            <Grid
                AbsoluteLayout.LayoutBounds="{Binding MainVM.Current.SourceBounds}"
                AbsoluteLayout.LayoutFlags="None">
                <Border
                    IsVisible="{Binding MainVM.Current}"
                    Padding="5"
                    StrokeThickness="0"
                    BackgroundColor="{StaticResource HelpPopupBackground}"/>
                <BoxView WidthRequest="1" BackgroundColor="Silver" HorizontalOptions="Start" VerticalOptions="Fill" />
                <BoxView WidthRequest="1" BackgroundColor="Silver" HorizontalOptions="End" VerticalOptions="Fill" />
                <BoxView HeightRequest="1" BackgroundColor="Silver" VerticalOptions="End" HorizontalOptions="Fill" />
            </Grid>

            <Grid
                AbsoluteLayout.LayoutBounds="0.5,0.35,1,0.49" AbsoluteLayout.LayoutFlags="All"
                HorizontalOptions="Center" VerticalOptions="Fill"
                RowDefinitions="*,auto">
                <Border
                    Stroke="Silver" Margin="0,0,0,15" VerticalOptions="Start">
                    <VerticalStackLayout
                        BackgroundColor="Black"
                        Padding="10">
                        <Label Text="Separate each color into different flasks" Style="{StaticResource LabelBullets}" />
                        <Label Text="You can only move matching colors onto each other" Style="{StaticResource LabelBullets}" />
                        <Label Text="You can always move colors to empty flask" Style="{StaticResource LabelBullets}" />
                        <Label Text="You can add empty flasks, if you are really stuck" Style="{StaticResource LabelBullets}" />
                    </VerticalStackLayout>
                </Border>

                <HorizontalStackLayout Spacing="4" Grid.Row="1" VerticalOptions="Start">
                    <Button Text="Previous" Command="{Binding MainVM.PreviousCommand}" Style="{StaticResource NavigationButton}" />
                    <Button Text="Next" Command="{Binding MainVM.NextCommand}" Style="{StaticResource NavigationButton}" />
                    <Button Text="Close" Command="{Binding CancelCommand}" BackgroundColor="OrangeRed" Margin="10,0,0,0" Style="{StaticResource NavigationButton}" />
                </HorizontalStackLayout>
            </Grid>

            <!--<AbsoluteLayout.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding CoachMarkManager.NavigateCommand}" CommandParameter="{x:Int32 1}" />
            </AbsoluteLayout.GestureRecognizers>-->
        </AbsoluteLayout>

        <!--<Button
            Text="Ã—"
            FontSize="55"
            Padding="0,-7,0,0"
            Command="{Binding CancelCommand}"
            Style="{StaticResource Cancel}"
            VerticalOptions="Start"
            HorizontalOptions="End"
            WidthRequest="70"
            HeightRequest="70"
            Margin="0,50,10,0"/>-->
    </Grid>

</ContentView>
